---
title: 非权威指南-正则表达式
header-img: back.png
header-color: 'rgb(255,255,255)'
tag-color: 'rgb(0,0,0)'
catalog: true
toc-number: false
date: 2020-02-21 10:58:41
tags: ['javaScript', 'RegExp', '正则']
---

## 1. 创建正则表达式

在 JavaScript 中有两种方式可以创建正则表达式：

- 使用正则表达式字面量，其由包含在斜杠之间的模式组成。

  当正则表达式保持不变时，使用该方法可以获得更好的性能

  ```js
  var re = /\d/g
  ```

- 调用 `RegExp` 的构造函数。

  适用于当正则表达式的模式会改变或者不知道模式并且从其他来源获取它(如用户输入)时

  ```js
  var re = new RegExp("\d")
  ```

## 2. 匹配单个字符

### 2.1 匹配纯文本

如果要匹配的字符为纯文本，则直接定义模式为该纯文本即可，比如要匹配 `apple`，可定义如下

```js
var re = /apple/
```

正则表达式引擎默认行为是只返回第一个匹配结果。如果要返回所有结果，可以使用 `g` 标志使其返回一个包含所有匹配结果的数组

```js
var re = /apple/g
```

如果要忽略大小写，可以使用 `i` 标志

```json
var re = /apple/i
```

### 2.2 匹配任意字符

使用`.`可以匹配任意的单个字符，甚至是 . 本身

```js
var re = /appl./
```

以上模式标识匹配 appl 加一个任意字符。“apple、appl1、appl.” 等都是匹配该模式的

### 2.3 匹配特殊字符

例如 `.` 等元字符在正则表达式中有特殊含义，如果要匹配这些字符需使用转义字符 `\`

```js
var re = /\./
```

以上模式表示匹配一个“.”字符

## 3. 匹配一组字符

### 3.1 匹配多组字符中的一个

在正则表达式中使用元字符`[`和``]` 定义一个字符集合。字符集合的匹配结果是能够与该集合里的任意一个成员相匹配的文本

```js
var re = /[abc]pple/
```

以上模式表示匹配 “apple” 或 “bpple” 或 “cpple”

还有一些预先定义好的字符区间：

- A-Z 匹配 A-Z 的所有大写字母
- a-z 匹配 a-z 的所有小写字母
- 0-9 匹配 0-9 的数字

需要注意的是: 连字符 `-` 是一个特殊的元字符，作为元字符他只能用在`[]` 之间，在字符集和以外的地方`-` 只是一个普通字符，只能与 “-” 匹配。因此 `-` 不需要被转义

在同一个字符集合里可以给出多个字符区间，比如如下模式

```js
var re = /[0-9a-zA-Z]/
```

该模式可以匹配任意大小写的字母或数字

### 3.2  取非匹配

使用元字符 `^` 可以匹配除了字符集合里的字符如：

```js
var re = /[^0-9]/
```

以上模式可以匹配所有非数字字符

需要注意的是: `^` 的效果作用于整个字符区间而不是紧跟着 `^` 的字符

## 4. 匹配元字符

元字符大概可分为两种：

- 用来匹配文本的，例如 `.`
- 正则表达式语法要求的，例如 `[]`

如果要匹配这些元字符本身，需要使用 `\` 转义

### 4.1 匹配空白字符

当需要对原始文本的非打印空白字符进行匹配(如制表符换行符等)时，这类字符很难直接输入到一个正则表达式中，但我们可以使用如下特殊元字符来输入它们:

| 元字符 | 说明                               |
| ------ | ---------------------------------- |
| [\b]   | 回退(并删除)一个字符 (BackSpace键) |
| \f     | 换页符                             |
| \n     | 换行符                             |
| \r     | 回车符                             |
| \t     | 制表符(tab键)                      |
| \v     | 垂直制表符                         |

```js
var re = /\r\n\r\n/
```

以上模式表示匹配空白行 (windows 操作系统)

### 4.2 匹配特定的字符类型

一些常用的字符集和可用特殊的元字符代替：

| 元字符 | 说明                                              |
| ------ | ------------------------------------------------- |
| \d     | 匹配任意数字（等价于 [0-9]）                      |
| \D     | 匹配任意非数字 （等价于 \[^0-9]）                 |
| \w     | 匹配任意字母数字下划线 （等价于 [0-9a-zA-Z_]）    |
| \W     | 匹配任意非字母数字下划线 （等价于 \[^0-9a-zA-Z]） |
| \s     | 匹配任意空白字符（等价于 [\f\n\r\t\v]）           |
| \S     | 匹配任意非空白字符 （等价于 [^\f\n\r\t\v）        |

## 5. 重复匹配

### 5.1 匹配零个或一个字符

如果要匹配一个出现0次或1次的字符，只需要给这个字符或者字符集加一个 `？` 作为后缀即可

```js
var re = /appled?/
```

表示匹配 apple 或 appled

### 5.2 匹配零个或多个字符

如果要匹配一个出现0次或1次或多次的字符，只需要给这个字符或者字符集加一个 `*` 作为后缀即可

```js
var re = /appled*/
```

表示匹配 apple 或者 appled 或者 appleddd 等

### 5.3 匹配一个或多个字符

要匹配同一个字符或字符集合的多次重复，只需要给这个字符或字符集和加一个 `+` 作为后缀即可。 `+` 匹配一个或多个字符。

需要注意的是在给字符集合加上 `+` 后缀的时候，必须把 `+` 放在字符集和的外面。

比如说 `[0-9]+` 是匹配的一个或多个数字，而 `[0-9+]` 匹配的是一个数字或者加号

来看一个例子

```js
var emailReg = /\w+@\w\.\w+/
```

以上模式表示匹配一个电子邮件地址，如 `fei@fei.com`

### 5.4 匹配的重复次数

正则表达式语言提供了一个设定重复次数的语法，用 `{}` 给出，数值写在中间

#### 5.4.1  为重复匹配次数设置一个精确的值

如果要给重复匹配次数设置一个精确的值只需要把这个值写在 `{}` 之间

```js
var re = /apple{3}/
```

以上模式表示匹配 appleee

#### 5.4.2 为重复匹配次数设置一个区间

可以设定一个最小值和一个最大值为重复匹配次数设置一个区间。这种区间必须以 `{min, max}` 的形式给出

```js
var re = /a{1, 3}/
```

以上模式表示匹配 a 或 aa  或 aaa

#### 5.4.3 为重复匹配次数设置一个下限

如果重复区间省略最大值部分即 `{min,}` 表示重复次数大于等于 min 次

```js
var re = /a{1,}/
```

以上模式表示匹配 a 或 aa 或 aaa 或 aaaaa 等

#### 5.4.4 防止过度匹配

`*` 和 `+` 都是 “贪婪型” 元字符，它们在进行匹配时会尽可能地从一段文本的开头一直匹配到文本的末尾，而不是从文本开头碰到第一个匹配为止。

在不需要这种行为时可以在贪婪型元字符后加一个 `?`

| 贪婪型元字符 | 懒惰型元字符 |
| ------------ | ------------ |
| +            | +？          |
| *            | *？          |
| {n, }        | {n, }?       |

## 6. 位置匹配

### 6.1 单词边界

使用 `\b` 定义单词边界

```js
var re = /\bcat\b/
```

该模式只能匹配到 cat 匹配不到 ccat 或 catt 等

### 6.2 字符串边界

用来定义字符串边界的元字符有两个：

- 用于定义字符串开头的 `^`
- 用于定义字符串结尾的 `$`

需要注意的是：`^` 是一个有多种用途的元字符。只有当它出现在一个字符集合里 (被放在`[]` 之间) 并紧跟`[` 时才能发挥求非作用。如果是在字符集和外面并处于一个模式的开头，`^`则匹配字符串的开头。

## 7. 使用子表达式

子表达式是一个更大的表达式的一部分，把一个表达式划分为一系列子表达式是为了把那些子表达式当作一个独立元素使用。子表达式必须使用 `()` 括起来，子表达式允许嵌套

```js
var re = /(apple){1, 2}/
```

该模式匹配 apple 或 appleapple

## 8. 回溯引用：前后一致匹配

使用 `\n` 表示第n个子表达式

## 9. 使用正则表达式

> `pattern.exec(str)` 
>
> 接收一个参数，即要应用模式的字符串，返回包含第一个匹配项信息的数组，或在没有匹配项的情况下返回 null。
>
> 在返回的数组中，第一项是与整个模式匹配的字符串，其他项是与模式种的捕获组匹配的字符串。数组还包含三个额外的属性:
>
> - index 表示匹配项在字符串中的位置
> - input 表示应用正则表达式的字符串
> - groups 存储命名捕获组信息

```js
var str = 'cat,bat,fat'
var pattern  = /c(a(?<test>t))/
var result = pattern.exec(str) 
console.log(result[0])  // cat
console.log(result[1])  // at
console.log(result[2])  // t
console.log(result.index)  // 0
console.log(result.input)  // cat,bat,fat
console.log(result.groups)  // [Object: null prototype] { test: 't' }
```

> `pattern.test(str)`
>
> 测试目标字符串与模式是否匹配

```js
var str = 'cat,bat,fat'
var pattern  = /[cf](a(?<test>t))/g
var result = pattern.test(str)
console.log(result);
```

